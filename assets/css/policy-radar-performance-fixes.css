/**
 * PolicyRadar CSS Performance Fixes
 * ==================================
 * 
 * Add these styles to fix animation-related performance issues.
 * Include this at the end of the <style> section in index.html.
 */

/* 
 * FIX: Stop infinite animations when tab is not visible
 * This prevents GPU from working on animations no one can see
 */
.hidden-tab .freshness-dot,
.hidden-tab .loading-spinner,
.hidden-tab .skeleton-line,
.hidden-tab [style*="animation"] {
    animation-play-state: paused !important;
}

/*
 * FIX: Reduce animation complexity on mobile
 * Mobile GPUs struggle with many simultaneous animations
 */
@media (max-width: 768px) {
    .freshness-dot {
        animation: none !important;
        opacity: 1;
    }
    
    .article-card:hover {
        transform: none; /* Disable hover transform on mobile */
    }
}

/*
 * FIX: Use GPU-friendly properties for animations
 * transform and opacity are GPU-accelerated, unlike top/left/width
 */
.article-card {
    will-change: auto; /* Don't hint will-change unless actively animating */
    contain: layout style; /* Limit layout/style recalculation scope */
}

/*
 * FIX: Reduce animation frequency for non-critical elements
 */
.freshness-dot {
    animation: pulse 4s ease-in-out infinite; /* Slower: 4s instead of 2s */
}

/* After page loads, stop the animation entirely */
body.loaded .freshness-dot {
    animation: none;
    opacity: 0.8;
}

/*
 * FIX: Ensure loading skeletons are removed, not just hidden
 * Hidden elements with animations still consume resources
 */
#loading-skeleton {
    display: none !important; /* Force removal when not needed */
}

#loading-skeleton.active {
    display: block !important;
}

/*
 * FIX: Prevent layout thrashing from scrolling
 */
.articles-grid {
    contain: content; /* Isolate from rest of document */
    content-visibility: auto; /* Skip rendering of off-screen content */
}

/*
 * FIX: Optimize article card rendering
 */
.article-card {
    contain: layout style paint; /* Full containment */
}

/*
 * FIX: Reduce paint complexity
 */
.article-card:hover {
    /* Use transform instead of box-shadow change for better performance */
    transform: translateY(-2px);
    /* Shadow is expensive - keep it constant or use a pseudo-element */
}

/*
 * Prefers reduced motion - respect user preference
 */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    .freshness-dot,
    .loading-spinner,
    .skeleton-line {
        animation: none !important;
    }
}
